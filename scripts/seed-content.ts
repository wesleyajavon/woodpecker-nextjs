#!/usr/bin/env tsx

/**
 * Content Seeding Script for Woodpecker
 * Migrates hardcoded content to database
 */

import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

async function main() {
  console.log('üå± Starting content seeding...');

  try {
    // Create FAQ Categories
    console.log('üìÅ Creating FAQ categories...');
    
    const faqCategories = [
      {
        name: 'licenses',
        slug: 'licenses',
        displayName: 'Licenses',
        icon: 'Shield',
        sortOrder: 1,
      },
      {
        name: 'payment',
        slug: 'payment',
        displayName: 'Payment',
        icon: 'CreditCard',
        sortOrder: 2,
      },
      {
        name: 'download',
        slug: 'download',
        displayName: 'Download',
        icon: 'Download',
        sortOrder: 3,
      },
      {
        name: 'usage',
        slug: 'usage',
        displayName: 'Usage',
        icon: 'Music',
        sortOrder: 4,
      },
      {
        name: 'account',
        slug: 'account',
        displayName: 'Account',
        icon: 'Users',
        sortOrder: 5,
      },
    ];

    for (const categoryData of faqCategories) {
      await prisma.fAQCategory.upsert({
        where: { slug: categoryData.slug },
        update: categoryData,
        create: categoryData,
      });
    }

    // Create FAQ Items (License)
    console.log('üí¨ Creating FAQ items (Licenses)...');
    const licensesCategory = await prisma.fAQCategory.findUnique({
      where: { slug: 'licenses' }
    });

    if (licensesCategory) {
      const licenseFAQs = [
        {
          question: 'Quelle est la diff√©rence entre les licences WAV, Trackout et Unlimited ?',
          answer: 'La licence WAV inclut les fichiers WAV et MP3 avec des droits limit√©s (5 000 copies, 100 000 streams). La licence Trackout ajoute les stems (pistes s√©par√©es) avec plus de droits (10 000 copies, 250 000 streams). La licence Unlimited offre tous les fichiers avec des droits illimit√©s pour un usage commercial complet.',
          categoryId: licensesCategory.id,
          sortOrder: 1,
        },
        {
          question: 'Puis-je utiliser le beat pour un usage commercial ?',
          answer: 'Oui, toutes nos licences permettent l\'usage commercial. Cependant, les licences WAV et Trackout t√™m des limitations sur le nombre de copies et de streams. Seule la licence Unlimited permet un usage commercial illimit√©.',
          categoryId: licensesCategory.id,
          sortOrder: 2,
        },
        {
          question: 'Le cr√©dit producteur est-il obligatoire ?',
          answer: 'Oui, le cr√©dit "Prod. l.outsider" est obligatoire sur tous les titres utilisant nos beats, quelle que soit la licence. Ce cr√©dit doit appara√Ætre clairement dans les m√©tadonn√©es et cr√©dits du morceau.',
          categoryId: licensesCategory.id,
          sortOrder: 3,
        },
        {
          question: 'Les licences sont-elles exclusives ?',
          answer: 'Non, nos licences standard ne sont pas exclusives. Le m√™me beat peut √™tre vendu √† plusieurs artistes. Pour une licence exclusive, contactez-nous directement pour un devis personnalis√©.',
          categoryId: licensesCategory.id,
          sortOrder: 4,
        },
        {
          question: 'Puis-je modifier le beat apr√®s l\'achat ?',
          answer: 'Oui, vous pouvez modifier, arranger et personnaliser le beat selon vos besoins artistiques. Les stems inclus dans les licences Trackout et Unlimited facilitent grandement ces modifications.',
          categoryId: licensesCategory.id,
          sortOrder: 5,
        },
      ];

      for (const faqData of licenseFAQs) {
        await prisma.fAQItem.create({
          data: {
            ...faqData,
            slug: faqData.question.toLowerCase()
              .replace(/[√†√°√¢√£√§√•]/g, 'a')
              .replace(/[√®√©√™√´]/g, 'e')
              .replace(/[√¨√≠√Æ√Ø]/g, 'i')
              .replace(/[√≤√≥√¥√µ√∂]/g, 'o')
              .replace(/[√π√∫√ª√º]/g, 'u')
              .replace(/[√ß]/g, 'c')
              .replace(/[^a-z0-9\s]/g, '')
              .replace(/\s+/g, '-'),
          },
        });
      }
    }

    // Create License Types
    console.log('üìÑ Creating license types...');
    
    const licenseTypes = [
      {
        name: 'wav',
        slug: 'wav',
        displayName: 'WAV Lease - Licence Non-Exclusive',
        description: 'Licence non-exclusive de 10 ans permettant l\'usage commercial du beat avec des droits essentiels pour artistes et producteurs.',
        basePrice: 19.99,
        features: [
          'Fichiers WAV haute qualit√© (24-bit/44.1kHz) et MP3 320kbps',
          'Droit d\'enregistrer des voix sur le beat pour cr√©er une nouvelle chanson',
          'Modification autoris√©e (arrangement, tempo, tonalit√©, dur√©e)',
          'Distribution jusqu\'√† 5 000 copies physiques et digitales',
          'Jusqu\'√† 100 000 streams audio mon√©tis√©s',
          '1 clip vid√©o mon√©tis√© (max 5 minutes)',
          'Performances live non-profit illimit√©es',
          'Vente en format single, EP ou album',
          'Partage des droits d\'auteur : 50% Producteur / 50% Artiste',
          'Pas de redevances suppl√©mentaires √† payer'
        ],
        limitations: [
          'Licence NON-EXCLUSIVE (le beat peut √™tre vendu √† d\'autres)',
          'Pas de fichiers stems/trackouts inclus',
          'Aucune performance live payante autoris√©e',
          'Pas de diffusion radio/TV commerciale',
          'Pas de synchronisation (films, pubs, jeux vid√©o)',
          'Interdiction de revendre le beat dans sa forme originale',
          'Pas de droit de sous-licencier √† des tiers',
          'Cr√©dit producteur \'Prod. l.outsider\' OBLIGATOIRE',
          'Dur√©e limit√©e √† 10 ans √† partir de l\'achat',
          'Interdiction d\'enregistrer le beat seul avec Content ID'
        ],
        useCases: [
          'Singles et projets musicaux ind√©pendants',
          'Mixtapes et compilations gratuites',
          'Streaming sur Spotify, Apple Music, Deezer',
          'Concerts et festivals non-commerciaux',
          'Promotion sur r√©seaux sociaux',
          'Vente digitale et physique limit√©e'
        ],
        maxCopies: 5000,
        maxStreams: 100000,
        maxVideos: 1,
        includesStems: false,
      },
      {
        name: 'trackout',
        slug: 'trackout',
        displayName: 'Trackout Lease - Licence Premium avec Stems',
        description: 'Licence non-exclusive de 10 ans incluant les stems pour un contr√¥le cr√©atif total et des droits commerciaux √©tendus.',
        basePrice: 39.99,
        features: [
          'Fichiers WAV haute qualit√© (24-bit/44.1kHz) et MP3 320kbps',
          'Stems/Trackouts complets (pistes s√©par√©es)',
          'Droit d\'enregistrer et modifier librement le beat',
          'Remixage et arrangements personnalis√©s autoris√©s',
          'Distribution jusqu\'√† 10 000 copies physiques et digitales',
          'Jusqu\'√† 250 000 streams audio mon√©tis√©s',
          '3 clips vid√©o mon√©tis√©s (max 5 minutes chacun)',
          'Performances live non-profit illimit√©es',
          'Vente en format single, EP ou album',
          'Partage des droits d\'auteur : 50% Producteur / 50% Artiste',
          'Pas de redevances suppl√©mentaires √† payer'
        ],
        limitations: [
          'Licence NON-EXCLUSIVE (le beat peut √™tre vendu √† d\'autres)',
          'Aucune performance live payante autoris√©e',
          'Pas de diffusion radio/TV commerciale',
          'Pas de synchronisation (films, pubs, jeux vid√©o)',
          'Interdiction de revendre le beat ou les stems dans leur forme originale',
          'Pas de droit de sous-licencier √† des tiers',
          'Cr√©dit producteur \'Prod. l.outsider\' OBLIGATOIRE',
          'Dur√©e limit√©e √† 10 ans √† partir de l\'achat'
        ],
        useCases: [
          'Albums et EPs professionnels',
          'Remixage et production avanc√©e',
          'Collaborations artistiques',
          'Clips vid√©o multiples et promotion',
          'Distribution √©largie sur plateformes',
          'Projets cr√©atifs n√©cessitant les stems'
        ],
        maxCopies: 10000,
        maxStreams: 250000,
        maxVideos: 3,
        includesStems: true,
      },
      {
        name: 'unlimited',
        slug: 'unlimited',
        displayName: 'Unlimited Lease - Licence Commerciale Compl√®te',
        description: 'Licence non-exclusive de 10 ans offrant tous les droits commerciaux pour une utilisation professionnelle sans limitations de distribution.',
        basePrice: 79.99,
        features: [
          'Fichiers WAV haute qualit√© (24-bit/44.1kHz) et MP3 320kbps',
          'Stems/Trackouts complets (pistes s√©par√©es)',
          'Droit d\'enregistrer et modifier librement le beat',
          'Distribution ILLIMIT√âE de copies physiques et digitales',
          'Streams audio mon√©tis√©s ILLIMIT√âS',
          'Clips vid√©o mon√©tis√©s ILLIMIT√âS',
          'Performances live payantes AUTORIS√âES',
          'Diffusion radio et t√©l√©vision commerciale',
          'Synchronisation (films, publicit√©s, documentaires, jeux vid√©o)',
          'Vente en format single, EP ou album sans restriction',
          'Partage des droits d\'auteur : 50% Producteur / 50% Artiste',
          'Pas de redevances suppl√©mentaires √† payer'
        ],
        limitations: [
          'Licence NON-EXCLUSIVE (le beat peut √™tre vendu √† d\'autres)',
          'Interdiction de revendre le beat ou les stems dans leur forme originale',
          'Pas de droit de sous-licencier √† des tiers',
          'Cr√©dit producteur \'Prod. l.outsider\' OBLIGATOIRE',
          'Dur√©e limit√©e √† 10 ans √† partir de l\'achat'
        ],
        useCases: [
          'Projets commerciaux majeurs et albums',
          'Tourn√©es et concerts payants',
          'Campagnes publicitaires et marketing',
          'Films, documentaires et contenus audiovisuels',
          'Diffusion radio/TV et podcasts',
          'Distribution mondiale sans restriction',
          'Synchronisation pour m√©dias et jeux vid√©o',
          'Projets n√©cessitant une flexibilit√© commerciale totale'
        ],
        maxCopies: null, // Unlimited
        maxStreams: null, // Unlimited
        maxVideos: null, // Unlimited
        includesStems: true,
        allowsLiveProfit: true,
        allowsRadioTV: true,
        allowsSync: true,
      },
    ];

    for (this: licenseData of licenseTypes) {
      await prisma.licenseInfo.upsert({
        where: { slug: licenseData.slug },
        update: licenseData,
        create: const licenseTypes = [
      {

      },
    ];

    for (const licenseData of licenseTypes) {
      await prisma.licenseInfo.upsert({
        where: { slug: licenseData.slug },
        update: licenseData,
        create: licenseData,
      });
    }

    console.log('‚úÖ Content seeding completed successfully!');
    console.log(`üìä Created:`);
    console.log(`- ${faqCategories.length} FAQ categories`);
    console.log(`- ${await prisma.fAQItem.count()} FAQ items`);
    console.log(`- ${licenseTypes.length} license types`);

  } catch (error) {
    console.error('‚ùå Error seeding content:', error);
    throw error;
  } finally {
    await prisma.$disconnect();
  }
}

main()
  .catch((e) => {
    console.error('üí• Seeding failed:', e);
    process.exit(1);
  });